---
title: "Tarea 2 - Estad铆stica Actuarial II"
author: 
  - Estudiantes
  - Luis Fernando Amey Apuy - C20470
  - Javier Antonio Hern谩ndez Navarro - C13674
  - Sof铆a Bocker Brenes - C11102
date: "`r Sys.Date()`"
output: 
  rmdformats::robobook:
    highlight: tango
---

# Librer铆as

```{r}
# install.packages("pacman")
pacman::p_load(
  ggplot2, 
  lubridate,
  tidyverse
)
```

# Pregunta 1

## Algoritmo de Integraci贸n por Montecarlo
Usando un Algoritmo de Integraci贸n por Montecarlo estime la siguiente integral: 
$$\int_0^1 \dfrac{e^{-x^2}}{1+x^2} \ dx$$ 
Usando la funci贸n _integrate_ de R, estime que el error de aproximaci贸n sea menor a $10^{-3}$, y mu茅strelo, esta funci贸n integrate utiliza el m茅todo de Simpson


# Pregunta 2

## a) Esperanza de $f_L(L)$
El valor esperado de una funci贸n de p茅rdida en una p贸liza de seguros, donde la p茅rdida $L$, sigue una distribuci贸n exponencial con par谩metro $\lambda = 1$. Queremos estimar el valor esperando de la siguiente funci贸n: 
$$E[L] = \int_0^\infty Lf_L(L) \ dL$$
Donde $f_L(L)$ es la funci贸n de densidad de la distribuci贸n de la p茅rdida $L$

## b) Programar $f_L(L)$
Programe la funci贸n de p茅rdida $f_L(L)$ seg煤n el enunciado

## c) Muestreo por importancia
Para muestrear valores extremos de nuestra muestra, podemos usar una distribuci贸n auxiliar
$$g(L) \sim N(3,4)$$
Implemente un muestreo por importancia con esta funci贸n auxiliar, para $n = 10^4$ e indique el valor esperado de la p茅rdida de los valores extremos, usando como semilla _set.seed(54321)_

# Pregunta 3
La siguiente muestra indica el tiempo en d铆as entre cada accidente laboral de una empresa:
$$2.72, 1.93, 1.76, 0.49, 6.12, 0.43, 4.01, 1.71, 2.01, 5.96$$
Se sabe que los tiempos entre accidentes poseen una distribuci贸n exponencial de par谩metro $\lambda$. Usaremos como funci贸n a priori de $\lambda$ una distribuci贸n gamma de par谩metros (2,1)

## a) Valor estimado de 
Indique el valor estimado de $\lambda$, utilizando el algoritmo de Aceptaci贸n y Rechazo.

## b) Distribuci贸n de 
Construya el histograma para la distribuci贸n de $\lambda$

## c) Generaciones
Indique el n煤mero de generaciones, n煤mero medio de generaciones y proporci贸n de rechazos de la estimaci贸n realizada

## d) Intervalo de credibilidad
Determine un intervalo de credibilidad al 99% para el par谩metro $\lambda$ estimado

## e) Hip贸tesis
Aceptar铆a o rechazar铆a la hip贸tesis que $\lambda = 0.5$, basados en el intervalo de credibilidad anterior. 

# Pregunta 4
Sea $f(x) = \exp\left(\frac{\sin(10x)}{10\cos(x)}\right)$, para $x \in [0,10]$

## a) Algoritmo de recalentamiento simulado
Utilizando el algoritmo de recalentamiento simulado estime el m铆nimo global en [0,10], con valor inicial en 5

## b) Gr谩fico de estados 
Grafique el resultado de los estados donde estuvo la cadena de la estimaci贸n del punto a.

# Pregunta 5
Dada una muestra de siniestros observados por periodo:
$$4,2,5,6,3,4,7,5,6,4$$
Suponemos que el n煤mero de siniestros en cada periodo sigue una distribuci贸n de Poisson con un par谩metro $\lambda$. Queremos estimar el par谩metro $\lambda$ usando el Algoritmo de Metropolis-Hastings, usaremos como funci贸n a priori de $\lambda$ una distribuci贸n gamma de par谩metros (3,2)

## a) Algoritmo de Metropolis-Hastings
Construya un algoritmo de Metropolis-Hastings que muestree el par谩metro $\lambda$, a partir de los datos suministrados con $n = 10^4$

## b) Traceplot
Gr谩fique el Traceplot de muestra MCMC del algoritmo

## c) Autocorrelaci贸n
El gr谩fico de Autocorrelaci贸n de la muestra MCMC del algoritmo.

## d) Convergencia de la media
El gr谩fico de la convergencia (promedios erg贸dicos) de la media de la muestra MCMC del algoritmo.

## e) Aceptaci贸n
La tasa de aceptaci贸n del algoritmo.


